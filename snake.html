<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Snake</title>
  <style>
    * {margin:0; padding:0; box-sizing:border-box;}
    html, body {
      overscroll-behavior-y: contain;
      height: 100%;
    }
    body {
      font-family: "Poppins", sans-serif;
      background: linear-gradient(135deg, rgb(240, 80, 176), #e780c8);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      color: #fff;
      flex-direction: column;
      overflow: hidden;
    }
    .game-container {
      background: rgba(255, 255, 255, 0.85);
      border-radius: 20px;
      padding: 20px;
      text-align: center;
      width: 95%;
      max-width: 400px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      position: relative;
    }
    h1 {
      font-size: 26px;
      color: #ff4081;
      margin-bottom: 10px;
      text-transform: uppercase;
      font-weight: 600;
    }
    canvas {
      background: #fff;
      border-radius: 15px;
      margin: 15px 0;
      width: 100%;
      height: auto;
      touch-action: none;
      z-index: 1; /* üîß pastikan di bawah overlay */
    }
    .score {
      font-size: 16px;
      margin: 5px 0;
      color: #333;
    }
    .game-over {
      position: absolute;
      display: none;
      background: rgba(255, 51, 133, 0.95);
      color: white;
      padding: 20px;
      border-radius: 12px;
      font-size: 20px;
      text-align: center;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      z-index: 9999; /* üîß overlay di atas canvas */
      pointer-events: auto; /* üîß tombol bisa diklik di HP */
    }
    .game-over button {
      margin-top: 10px;
      background: white;
      border: none;
      padding: 10px 20px;
      font-size: 16px;
      color: #ff3385;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.3s;
    }
    .game-over button:hover {
      background: #ff66b2;
      color: white;
    }
    .game-menu {margin-top: 15px;}
    .menu-btn {
      background: #ff80ab;
      color: white;
      border: none;
      padding: 8px 12px;
      margin: 5px;
      border-radius: 8px;
      font-size: 14px;
      cursor: pointer;
      transition: 0.3s;
    }
    .menu-btn:hover {background: #ff4081;}
  </style>
</head>
<body>
  <div class="game-container">
    <h1>Snake</h1>
    <div class="score">Skor: <span id="score">0</span> | High Score: <span id="highScore">0</span></div>
    <canvas id="gameCanvas" width="300" height="300"></canvas>

    <div id="gameOverScreen" class="game-over">
      <p id="gameOverText">yahh kalah! Skor: 0</p>
      <button onclick="restartGame()">coba lagii</button>
    </div>

    <div class="game-menu">
      <h2 style="color:#ff4081; font-size:16px;">pilih game lain:</h2>
      <button class="menu-btn" onclick="location.href='index.html'">üî¢ Tebak Angka</button>
      <button class="menu-btn" onclick="location.href='bird.html'">üê¶ Flappy Pink Bird</button>
      <button class="menu-btn" onclick="location.href='puzzle.html'">üß© Sliding Puzzle</button>
    </div>
  </div>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const scoreEl = document.getElementById("score");
    const highScoreEl = document.getElementById("highScore");
    const gameOverScreen = document.getElementById("gameOverScreen");
    const gameOverText = document.getElementById("gameOverText");

    let TILE = 15;
    let snake, food, dx, dy, score, speed, gameLoop, highScore;
    let gameOver = false;

    highScore = localStorage.getItem("snakeHighScore") || 0;
    highScoreEl.textContent = highScore;

    function resizeCanvas(){
      const size = Math.min(window.innerWidth*0.8, 300);
      canvas.width = size;
      canvas.height = size;
    }

    function init() {
      resizeCanvas();
      snake = [{x:10, y:10}];
      food = spawnFood();
      dx = 1; dy = 0;
      score = 0;
      speed = 4;
      gameOver = false;
      scoreEl.textContent = score;
      gameOverScreen.style.display = "none";
      if (gameLoop) clearInterval(gameLoop);
      gameLoop = setInterval(draw, 1000/speed);
    }

    function spawnFood() {
      return {
        x: Math.floor(Math.random() * (canvas.width / TILE)),
        y: Math.floor(Math.random() * (canvas.height / TILE))
      };
    }

    function draw() {
      ctx.fillStyle = "#fff";
      ctx.fillRect(0,0,canvas.width,canvas.height);

      ctx.font = "18px sans-serif";
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";
      ctx.fillText("üçì", food.x*TILE + TILE/2, food.y*TILE + TILE/2);

      snake.forEach((s,i)=>{
        ctx.fillStyle = i===0 ? "#ff4081" : "#ff80ab";
        ctx.fillRect(s.x*TILE+1, s.y*TILE+1, TILE-2, TILE-2);
        ctx.strokeStyle="#fff";
        ctx.strokeRect(s.x*TILE+1, s.y*TILE+1, TILE-2, TILE-2);
      });

      const head = {x:snake[0].x+dx, y:snake[0].y+dy};
      if(head.x<0||head.y<0||head.x>=canvas.width/TILE||head.y>=canvas.height/TILE||snake.some(s=>s.x===head.x&&s.y===head.y)){
        showGameOver();
        return;
      }
      snake.unshift(head);
      if(head.x===food.x && head.y===food.y){
        score++;
        scoreEl.textContent = score;
        food = spawnFood();
        if(score % 5 ===0){
          speed+=0.3;
          clearInterval(gameLoop);
          gameLoop=setInterval(draw,1000/speed);
        }
      } else {
        snake.pop();
      }
    }

    function showGameOver(){
      clearInterval(gameLoop);
      gameLoop = null;
      gameOver = true;
      gameOverText.textContent = `nice try! skor: ${score}`;
      gameOverScreen.style.display = "block";
      if(score>highScore){
        highScore=score;
        localStorage.setItem("snakeHighScore",highScore);
        highScoreEl.textContent=highScore;
      }
    }

    function restartGame() {
      init();
    }

    document.addEventListener("keydown", e=>{
      if(e.key==="ArrowUp"&&dy!==1){dx=0;dy=-1;}
      else if(e.key==="ArrowDown"&&dy!==-1){dx=0;dy=1;}
      else if(e.key==="ArrowLeft"&&dx!==1){dx=-1;dy=0;}
      else if(e.key==="ArrowRight"&&dx!==-1){dx=1;dy=0;}
    });

    let touchStartX=0, touchStartY=0;
    document.addEventListener("touchstart", e=>{
      touchStartX = e.changedTouches[0].clientX;
      touchStartY = e.changedTouches[0].clientY;
    }, {passive:false});
    document.addEventListener("touchend", e=>{
      let dxTouch = e.changedTouches[0].clientX - touchStartX;
      let dyTouch = e.changedTouches[0].clientY - touchStartY;
      if(Math.abs(dxTouch) > Math.abs(dyTouch)){
        if(dxTouch > 30 && dx !== -1){ dx = 1; dy = 0; }
        else if(dxTouch < -30 && dx !== 1){ dx = -1; dy = 0; }
      } else {
        if(dyTouch > 30 && dy !== -1){ dx = 0; dy = 1; }
        else if(dyTouch < -30 && dy !== 1){ dx = 0; dy = -1; }
      }
      e.preventDefault();
    }, {passive:false});

    window.addEventListener("resize", resizeCanvas);
    init();
  </script>
</body>
</html>
